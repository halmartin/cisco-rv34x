# Generated by ip6tables-save v1.4.10 on Thu Jul 12 18:56:49 2012
*raw
:PREROUTING ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
COMMIT
# Completed on Thu Jul 12 18:56:49 2012
# Generated by ip6tables-save v1.4.10 on Thu Jul 12 18:56:49 2012
*mangle
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
COMMIT
# Completed on Thu Jul 12 18:56:49 2012
# Generated by ip6tables-save v1.4.10 on Thu Jul 12 18:56:49 2012
*filter
:INPUT ACCEPT [0:0]
:FORWARD DROP [0:0]
:OUTPUT DROP [0:0]
:accept_log - [0:0]
:content_filter - [0:0]
:delegate_forward - [0:0]
:delegate_input - [0:0]
:delegate_output - [0:0]
:drop_log - [0:0]
:firewall_disable - [0:0]
:forward_rule - [0:0]
:forward_vlan_defaults - [0:0]
:icmp_flood - [0:0]
:icmp_flood_rules - [0:0]
:input_rule - [0:0]
:input_wan_defaults - [0:0]
:inter_vlan_routing - [0:0]
:output_rule - [0:0]
:ping_of_death - [0:0]
:ping_of_death_rules - [0:0]
:ripng_fw_bypass - [0:0]
:syn_flood - [0:0]
:syn_flood_rules - [0:0]
:udp_flood - [0:0]
:udp_flood_rules - [0:0]
:upnp6_internal - [0:0]
:device_management - [0:0]
-A INPUT -j icmp_flood 
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT 
-A INPUT -m conntrack --ctstate INVALID -j DROP 
-A INPUT -p udp -m udp --sport 547 --dport 546 -m conntrack --ctstate NEW -j ACCEPT 
-A INPUT -p ipv6-icmp -m icmp6 --icmpv6-type 134 -m hl --hl-eq 255 -j ACCEPT 
-A INPUT -p ipv6-icmp -m icmp6 --icmpv6-type 135 -m hl --hl-eq 255 -j ACCEPT 
-A INPUT -p ipv6-icmp -m icmp6 --icmpv6-type 136 -m hl --hl-eq 255 -j ACCEPT 
-A INPUT -i lo -j ACCEPT 
-A INPUT -j syn_flood 
-A INPUT -j udp_flood 
-A INPUT -j ping_of_death 
-A INPUT -j device_management 
-A INPUT -j input_rule 
-A INPUT -j delegate_input 
-A INPUT -j firewall_disable 
-A INPUT -j input_wan_defaults 
-A FORWARD -p tcp -m tcp --dport 80 -j content_filter 
-A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT 
-A FORWARD -p tcp -m tcp ! --tcp-flags FIN,SYN,RST,ACK SYN -m state --state NEW -j LOG --log-prefix "FIREWALL:PACKET DROP" 
-A FORWARD -p tcp -m tcp ! --tcp-flags FIN,SYN,RST,ACK SYN -m state --state NEW -j REJECT --reject-with tcp-reset 
-A FORWARD -m conntrack --ctstate INVALID -j DROP 
-A FORWARD -j forward_rule 
-A FORWARD -j delegate_forward 
-A FORWARD -j firewall_disable 
-A FORWARD -j forward_vlan_defaults 
-A OUTPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT 
-A OUTPUT -p ipv6-icmp -m icmp6 --icmpv6-type 128 -j ACCEPT 
-A OUTPUT -m conntrack --ctstate INVALID -j DROP 
-A OUTPUT -o lo -j ACCEPT 
-A OUTPUT -j output_rule 
-A OUTPUT -j delegate_output 
-A OUTPUT -j firewall_disable 
-A accept_log -j LOG --log-prefix "FIREWALL ACCEPT:" --log-level 6 
-A accept_log -j ACCEPT 
-A delegate_forward -j inter_vlan_routing 
-A delegate_input -j ripng_fw_bypass 
-A delegate_input -j upnp6_internal 
-A drop_log -j LOG --log-prefix "FIREWALL DROP:" --log-level 6 
-A drop_log -j DROP 
-A icmp_flood_rules -m limit --limit 100/sec --limit-burst 50 -j RETURN 
-A icmp_flood_rules -m limit --limit 1/sec -j LOG --log-prefix "FIREWALL ICMP-FLOOD:" 
-A icmp_flood_rules -j DROP 
-A input_wan_defaults -i br-wan+ -p tcp -m multiport --dports 80,443 -j ACCEPT 
-A input_wan_defaults -i eth0+ -j DROP 
-A input_wan_defaults -i ppoe-wan16+ -j DROP 
-A input_wan_defaults -i 3g-usb+ -j DROP 
-A input_wan_defaults -i wwan+ -j DROP 
-A ping_of_death_rules -m length --length 60:65535 -j RETURN 
-A ping_of_death_rules -m limit --limit 1/sec -j LOG --log-prefix "FIREWALL PING-OF-DEATH" 
-A ping_of_death_rules -j DROP 
-A ripng_fw_bypass -i br-wan+ -p udp -m udp --sport 521 --dport 521 -j ACCEPT 
-A ripng_fw_bypass -i eth0+ -p udp -m udp --sport 521 --dport 521 -j ACCEPT 
-A ripng_fw_bypass -i ppoe-wan16+ -p udp -m udp --sport 521 --dport 521 -j ACCEPT 
-A ripng_fw_bypass -i 3g-usb+ -p udp -m udp --sport 521 --dport 521 -j ACCEPT 
-A ripng_fw_bypass -i wwan+ -p udp -m udp --sport 521 --dport 521 -j ACCEPT 
-A syn_flood_rules -m limit --limit 128/sec --limit-burst 50 -j RETURN 
-A syn_flood_rules -m limit --limit 1/sec -j LOG --log-prefix "FIREWALL SYN-FLOOD:" 
-A syn_flood_rules -j DROP 
-A udp_flood_rules -p udp -m limit --limit 1000/sec --limit-burst 50 -j RETURN 
-A udp_flood_rules -m limit --limit 1/sec -j LOG --log-prefix "FIREWALL UDP-FLOOD:" 
-A udp_flood_rules -j DROP 
COMMIT
# Completed on Thu Jul 12 18:56:49 2012
