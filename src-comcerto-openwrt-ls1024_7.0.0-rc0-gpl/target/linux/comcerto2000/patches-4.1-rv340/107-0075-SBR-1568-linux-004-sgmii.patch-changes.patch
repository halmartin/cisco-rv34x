diff -aurN '--exclude-from=/tmp/files' linux-4.1.8-orig/arch/arm/mach-comcerto/board-c2kasic.c linux-4.1.8/arch/arm/mach-comcerto/board-c2kasic.c
--- linux-4.1.8-orig/arch/arm/mach-comcerto/board-c2kasic.c	2017-08-16 16:26:20.887519138 +0530
+++ linux-4.1.8/arch/arm/mach-comcerto/board-c2kasic.c	2017-08-16 16:28:00.011517253 +0530
@@ -57,6 +57,8 @@
 #include <asm/mach/time.h>
 #include <mach/gpio.h>
 
+#include <mach/reset.h>
+#include <mach/serdes-c2000.h>
 
 //#include <mach/comcerto-2000/timer.h>
 extern void comcerto_timer_init(void);
@@ -683,9 +685,9 @@
 	.comcerto_eth_pdata[2] = {
 		.name = GEM2_ITF_NAME,
 		.device_flags = CONFIG_COMCERTO_GEMAC,
-		.mii_config = CONFIG_COMCERTO_USE_RGMII,
+		.mii_config = CONFIG_COMCERTO_USE_SGMII,
 		.gemac_mode = GEMAC_SW_CONF | GEMAC_SW_FULL_DUPLEX | GEMAC_SW_SPEED_1G,
-		.phy_flags = GEMAC_PHY_RGMII_ADD_DELAY,
+		.phy_flags = GEMAC_NO_PHY,
 		.bus_id = 0,
 		.phy_id = 6,
 		.gem_id = 2,
diff -aurN '--exclude-from=/tmp/files' linux-4.1.8-orig/arch/arm/mach-comcerto/comcerto-2000.c linux-4.1.8/arch/arm/mach-comcerto/comcerto-2000.c
--- linux-4.1.8-orig/arch/arm/mach-comcerto/comcerto-2000.c	2017-08-16 16:26:20.887519138 +0530
+++ linux-4.1.8/arch/arm/mach-comcerto/comcerto-2000.c	2017-08-16 16:31:14.987513546 +0530
@@ -55,7 +55,6 @@
 #include <asm/hardware/cache-l2x0.h>
 #include <mach/comcerto-2000.h>
 #include <linux/ahci_platform.h>
-#include <mach/serdes-c2000.h>
 #include <linux/clockchips.h>
 #include <linux/clk.h>
 #include <mach/comcerto-2000/clock.h>
@@ -73,6 +72,10 @@
 EXPORT_SYMBOL(exp_bus_lock);
 #endif /* CONFIG_COMCERTO_EXP_BUS_LOCK */
 
+//#define        C2K_SGMII_SUPPORT
+#define        C2K_SGMII_CONFIG_SUPPORT
+#include <mach/serdes-c2000.h>
+
 struct c2k_gpio_pin_stat_info c2k_gpio_pin_stat =
 {
 	.c2k_gpio_pins_0_31 = 0x0,
@@ -168,6 +171,26 @@
 	},
 };
 
+static void sgmii_init(void)
+{
+	printk("%s: sgmii initialize serdes2 !!\n\n", __func__);
+
+	//Bring Serdes2 out of reset
+	c2000_block_reset(COMPONENT_SERDES2,0);
+
+	writel(readl(COMCERTO_DWC1_CFG_BASE + 0x58) & ~0xFF33, COMCERTO_DWC1_CFG_BASE + 0x58);
+	writel((readl(COMCERTO_DWC1_CFG_BASE + 0x54) & ~0xFF33) | 0x133, COMCERTO_DWC1_CFG_BASE + 0X54);
+
+	/* Serdes Initialization. */
+	if( serdes_phy_init(2,  gemac2_phy_reg_file_sgmii,
+				sizeof(gemac2_phy_reg_file_sgmii) / sizeof(serdes_regs_t),
+				SD_DEV_TYPE_SGMII) )
+	{
+		printk(KERN_ERR "%s: Failed to initialize serdes2 !!\n", __func__);
+		return -1;
+	}
+}
+
 #if defined(CONFIG_COMCERTO_64K_PAGES)
 #define PFE_DMA_SIZE		(4 * SZ_1M)
 #else
@@ -479,9 +502,11 @@
 	}
 	else
 	{
+	#ifndef	C2K_SGMII_SUPPORT
 		p_sata_phy_reg_file = &sata_phy_reg_file_48[0];
 		serdes_regs_size = sizeof(sata_phy_reg_file_48);
 		printk(KERN_INFO "SATA Serdes: 48Mhz ref clk\n");
+	#endif
 	}
 
 	//Take SATA AXI domain out of reset
@@ -490,7 +515,7 @@
 	c2000_block_reset(COMPONENT_SATA_PMU,0);
 	c2000_block_reset(COMPONENT_SATA_OOB,0);
 
-        if ( (val & BOOT_SERDES1_CNF_SATA0) || (!(val & BOOT_SERDES2_CNF_SATA1)))
+        if ( (val & BOOT_SERDES1_CNF_SATA0) || (!(val & BOOT_SERDES2_CNF_SATA1)) || (val & BOOT_SERDES2_CNF_SATA1))
         {
                 if (val & BOOT_SERDES1_CNF_SATA0)
                 {
@@ -526,6 +551,20 @@
                                 return -1;
                         }
                 }
+
+		if (val & BOOT_SERDES2_CNF_SATA1)
+		{
+			printk("pratap:%s: Initializing serdes2 for SGMII val=0x%x... \n", __func__, val);
+			#ifdef CONFIG_C2K_RV340
+			/* GPIO01 - RTL8382M & RTL8231 Reset
+			Setting now GPIO01 as low
+			It should be set High after kernel bootups and prior to switch init */
+			writel(readl(COMCERTO_GPIO_OE_REG) | GPIO_PIN_1, COMCERTO_GPIO_OE_REG);
+			writel(readl(COMCERTO_GPIO_OUTPUT_REG) & ~GPIO_PIN_1, COMCERTO_GPIO_OUTPUT_REG);
+			udelay(1000);
+			#endif
+			sgmii_init();
+                }
         } else
                 return -1;
 
diff -aurN '--exclude-from=/tmp/files' linux-4.1.8-orig/arch/arm/mach-comcerto/include/mach/serdes-c2000.h linux-4.1.8/arch/arm/mach-comcerto/include/mach/serdes-c2000.h
--- linux-4.1.8-orig/arch/arm/mach-comcerto/include/mach/serdes-c2000.h	2017-08-16 16:26:20.887519138 +0530
+++ linux-4.1.8/arch/arm/mach-comcerto/include/mach/serdes-c2000.h	2017-08-16 16:42:51.947500295 +0530
@@ -27,6 +27,8 @@
  */
 /* SER-DES Address space */
 
+#ifndef __SERDES_H__
+#define __SERDES_H__
 
 typedef struct serdes_regs_s
 {
@@ -37,6 +39,9 @@
 int serdes_phy_init(int phy_num, struct serdes_regs_s *regs, int size, int type);
 void serdes_phy_reset(int phy_num);
 
+
+#ifndef	C2K_SGMII_SUPPORT
+
 #ifdef CONFIG_COMCERTO_SATA
  /*  Initialize values of the Snowbush PHY (Serdes1) for SATA0 */
 
@@ -1993,5 +1998,330 @@
    	  { 0x000 << 2, 0x07}
 	};
 #endif /* endif for CONFIG_PCI */
+#endif
 
 
+#ifdef  C2K_SGMII_CONFIG_SUPPORT
+static struct serdes_regs_s gemac2_phy_reg_file_sgmii[] =
+{
+	{ 0x000 << 2, 0x06},
+	{ 0x001 << 2, 0x00},
+	{ 0x002 << 2, 0x00},
+	{ 0x003 << 2, 0x00},
+	{ 0x004 << 2, 0x00},
+	{ 0x005 << 2, 0x00},
+	{ 0x006 << 2, 0x00},
+	{ 0x007 << 2, 0x00},
+	{ 0x008 << 2, 0x00},
+	{ 0x009 << 2, 0x00},
+	{ 0x00A << 2, 0x00},
+	{ 0x00B << 2, 0x00},
+	{ 0x00C << 2, 0x00},
+	{ 0x00D << 2, 0x00},
+	{ 0x00E << 2, 0x00},
+	{ 0x00F << 2, 0x00},
+	{ 0x010 << 2, 0x00},
+	{ 0x011 << 2, 0x00},
+	{ 0x012 << 2, 0x00},
+	{ 0x013 << 2, 0x00},
+	{ 0x014 << 2, 0x00},
+	{ 0x015 << 2, 0x00},
+	{ 0x016 << 2, 0x00},
+	{ 0x017 << 2, 0x00},
+	{ 0x018 << 2, 0x00},
+	{ 0x019 << 2, 0x00},
+	{ 0x01A << 2, 0x00},
+	{ 0x01B << 2, 0x00},
+	{ 0x01C << 2, 0x00},
+	{ 0x01D << 2, 0x00},
+	{ 0x01E << 2, 0x00},
+	{ 0x01F << 2, 0x00},
+	{ 0x020 << 2, 0x00},
+	{ 0x021 << 2, 0x00},
+	{ 0x022 << 2, 0xa0},
+	{ 0x023 << 2, 0x74},
+	{ 0x024 << 2, 0x00},
+	{ 0x025 << 2, 0x00},
+	{ 0x026 << 2, 0x00},
+	{ 0x027 << 2, 0x00},
+	{ 0x028 << 2, 0x00},
+	{ 0x029 << 2, 0x00},
+	{ 0x02A << 2, 0x00},
+	{ 0x02B << 2, 0x00},
+	{ 0x02C << 2, 0x00},
+	{ 0x02D << 2, 0x00},
+	{ 0x02E << 2, 0x04},
+	{ 0x02F << 2, 0x50},
+	{ 0x030 << 2, 0x70},
+	{ 0x031 << 2, 0x02},
+	{ 0x032 << 2, 0x25},
+	{ 0x033 << 2, 0x40},
+	{ 0x034 << 2, 0x01},
+	{ 0x035 << 2, 0x40},
+	{ 0x036 << 2, 0x00},
+	{ 0x037 << 2, 0x00},
+	{ 0x038 << 2, 0x00},
+	{ 0x039 << 2, 0x00},
+	{ 0x03A << 2, 0x00},
+	{ 0x03B << 2, 0x00},
+	{ 0x03C << 2, 0x00},
+	{ 0x03D << 2, 0x00},
+	{ 0x03E << 2, 0x00},
+	{ 0x03F << 2, 0x00},
+	{ 0x040 << 2, 0x00},
+	{ 0x041 << 2, 0x00},
+	{ 0x042 << 2, 0x00},
+	{ 0x043 << 2, 0x00},
+	{ 0x044 << 2, 0x00},
+	{ 0x045 << 2, 0x00},
+	{ 0x046 << 2, 0x00},
+	{ 0x047 << 2, 0x00},
+	{ 0x048 << 2, 0x00},
+	{ 0x049 << 2, 0x00},
+	{ 0x04A << 2, 0x00},
+	{ 0x04B << 2, 0x00},
+	{ 0x04C << 2, 0x00},
+	{ 0x04D << 2, 0x00},
+	{ 0x04E << 2, 0x00},
+	{ 0x04F << 2, 0x00},
+	{ 0x050 << 2, 0x00},
+	{ 0x051 << 2, 0x00},
+	{ 0x052 << 2, 0x00},
+	{ 0x053 << 2, 0x00},
+	{ 0x054 << 2, 0x00},
+	{ 0x055 << 2, 0x00},
+	{ 0x056 << 2, 0x00},
+	{ 0x057 << 2, 0x00},
+	{ 0x058 << 2, 0x00},
+	{ 0x059 << 2, 0x00},
+	{ 0x05A << 2, 0x00},
+	{ 0x05B << 2, 0x00},
+	{ 0x05C << 2, 0x00},
+	{ 0x05D << 2, 0x00},
+	{ 0x05E << 2, 0x00},
+	{ 0x05F << 2, 0x00},
+	{ 0x060 << 2, 0x00},
+	{ 0x061 << 2, 0x2e},
+	{ 0x062 << 2, 0x00},
+	{ 0x063 << 2, 0x5e},
+	{ 0x064 << 2, 0x00},
+	{ 0x065 << 2, 0x42},
+	{ 0x066 << 2, 0xd1},
+	{ 0x067 << 2, 0x20},
+	{ 0x068 << 2, 0x08},
+	{ 0x069 << 2, 0x50},
+	{ 0x06A << 2, 0x44},
+	{ 0x06B << 2, 0x4e},
+	{ 0x06C << 2, 0x09},
+	{ 0x06D << 2, 0x00},
+	{ 0x06E << 2, 0x00},
+	{ 0x06F << 2, 0x00},
+	{ 0x070 << 2, 0x00},
+	{ 0x071 << 2, 0x00},
+	{ 0x072 << 2, 0x00},
+	{ 0x200 << 2, 0x02},
+	{ 0x201 << 2, 0x00},
+	{ 0x202 << 2, 0x00},
+	{ 0x203 << 2, 0x00},
+	{ 0x204 << 2, 0x00},
+	{ 0x205 << 2, 0x10},
+	{ 0x206 << 2, 0x84},
+	{ 0x207 << 2, 0x28},
+	{ 0x208 << 2, 0xe0},
+	{ 0x210 << 2, 0x23},
+	{ 0x211 << 2, 0x00},
+	{ 0x212 << 2, 0x00},
+	{ 0x213 << 2, 0x04},
+	{ 0x214 << 2, 0x38},
+	{ 0x215 << 2, 0x04},
+	{ 0x216 << 2, 0x00},
+	{ 0x217 << 2, 0x08},
+	{ 0x218 << 2, 0xa2},
+	{ 0x219 << 2, 0x1e},
+	{ 0x21A << 2, 0x18},
+	{ 0x21B << 2, 0x0d},
+	{ 0x21C << 2, 0x0d},
+	{ 0x21D << 2, 0x00},
+	{ 0x21E << 2, 0x00},
+	{ 0x21F << 2, 0x00},
+	{ 0x220 << 2, 0x00},
+	{ 0x221 << 2, 0x00},
+	{ 0x222 << 2, 0x00},
+	{ 0x223 << 2, 0x00},
+	{ 0x224 << 2, 0x00},
+	{ 0x225 << 2, 0x00},
+	{ 0x226 << 2, 0x00},
+	{ 0x227 << 2, 0x00},
+	{ 0x228 << 2, 0x00},
+	{ 0x229 << 2, 0x00},
+	{ 0x22A << 2, 0x00},
+	{ 0x22B << 2, 0x00},
+	{ 0x22C << 2, 0x00},
+	{ 0x22D << 2, 0x00},
+	{ 0x22E << 2, 0x00},
+	{ 0x22F << 2, 0x00},
+	{ 0x230 << 2, 0x00},
+	{ 0x231 << 2, 0x00},
+	{ 0x232 << 2, 0x00},
+	{ 0x233 << 2, 0x00},
+	{ 0x234 << 2, 0x00},
+	{ 0x235 << 2, 0x00},
+	{ 0x236 << 2, 0x00},
+	{ 0x237 << 2, 0x00},
+	{ 0x238 << 2, 0x00},
+	{ 0x239 << 2, 0x00},
+	{ 0x23A << 2, 0x00},
+	{ 0x23B << 2, 0x00},
+	{ 0x23C << 2, 0x00},
+	{ 0x23D << 2, 0x00},
+	{ 0x23E << 2, 0x00},
+	{ 0x23F << 2, 0x00},
+	{ 0x240 << 2, 0x00},
+	{ 0x241 << 2, 0x00},
+	{ 0x242 << 2, 0x00},
+	{ 0x243 << 2, 0x00},
+	{ 0x244 << 2, 0x00},
+	{ 0x245 << 2, 0x00},
+	{ 0x246 << 2, 0x00},
+	{ 0x247 << 2, 0x00},
+	{ 0x248 << 2, 0x00},
+	{ 0x249 << 2, 0x00},
+	{ 0x24A << 2, 0x00},
+	{ 0x24B << 2, 0x00},
+	{ 0x24C << 2, 0x00},
+	{ 0x24D << 2, 0x00},
+	{ 0x24E << 2, 0x00},
+	{ 0x24F << 2, 0x00},
+	{ 0x250 << 2, 0x60},
+	{ 0x251 << 2, 0x0f},
+	{ 0xa00 << 2, 0x00},
+	{ 0xa01 << 2, 0x20},
+	{ 0xa02 << 2, 0x00},
+	{ 0xa03 << 2, 0x40},
+	{ 0xa04 << 2, 0x3c},
+	{ 0xa05 << 2, 0x00},
+	{ 0xa06 << 2, 0x00},
+	{ 0xa07 << 2, 0x00},
+	{ 0xa08 << 2, 0x00},
+	{ 0xa09 << 2, 0x13},
+	{ 0xa0A << 2, 0x44},
+	{ 0xa0B << 2, 0xc7},
+	{ 0xa0C << 2, 0x01},
+	{ 0xa0D << 2, 0x03},
+	{ 0xa0E << 2, 0x28},
+	{ 0xa0F << 2, 0x98},
+	{ 0xa10 << 2, 0x19},
+	{ 0xa11 << 2, 0x28},
+	{ 0xa12 << 2, 0xb8},
+	{ 0xa13 << 2, 0xc8},
+	{ 0xa14 << 2, 0xf0},
+	{ 0xa15 << 2, 0x90},
+	{ 0xa16 << 2, 0xb5},
+	{ 0xa17 << 2, 0x01},
+	{ 0xa30 << 2, 0x00},
+	{ 0xa31 << 2, 0x00},
+	{ 0xa32 << 2, 0x00},
+	{ 0xa33 << 2, 0x00},
+	{ 0xa34 << 2, 0x00},
+	{ 0xa35 << 2, 0x00},
+	{ 0xa36 << 2, 0x00},
+	{ 0xa37 << 2, 0x00},
+	{ 0xa38 << 2, 0x00},
+	{ 0xa39 << 2, 0xa0},
+	{ 0xa3A << 2, 0xa0},
+	{ 0xa3B << 2, 0xa0},
+	{ 0xa3C << 2, 0xa0},
+	{ 0xa3D << 2, 0xa0},
+	{ 0xa3E << 2, 0xa0},
+	{ 0xa3F << 2, 0xa0},
+	{ 0xa40 << 2, 0x74},
+	{ 0xa41 << 2, 0x00},
+	{ 0xa42 << 2, 0x80},
+	{ 0xa43 << 2, 0x58},
+	{ 0xa44 << 2, 0x00},
+	{ 0xa45 << 2, 0x44},
+	{ 0xa46 << 2, 0x5c},
+	{ 0xa47 << 2, 0x86},
+	{ 0xa48 << 2, 0x8d},
+	{ 0xa49 << 2, 0xd0},
+	{ 0xa4A << 2, 0x09},
+	{ 0xa4B << 2, 0x90},
+	{ 0xa4C << 2, 0x07},
+	{ 0xa4D << 2, 0x40},
+	{ 0xa4E << 2, 0x00},
+	{ 0xa4F << 2, 0x00},
+	{ 0xa50 << 2, 0x00},
+	{ 0xa51 << 2, 0x20},
+	{ 0xa52 << 2, 0x32},
+	{ 0xa53 << 2, 0x00},
+	{ 0xa54 << 2, 0x00},
+	{ 0xa55 << 2, 0x00},
+	{ 0xa56 << 2, 0x00},
+	{ 0xa57 << 2, 0x00},
+	{ 0xa58 << 2, 0x00},
+	{ 0xa59 << 2, 0x00},
+	{ 0xa5A << 2, 0x00},
+	{ 0xa5B << 2, 0x00},
+	{ 0xa5C << 2, 0x00},
+	{ 0xa5D << 2, 0x00},
+	{ 0xa5E << 2, 0x00},
+	{ 0xa5F << 2, 0x00},
+	{ 0xa60 << 2, 0x00},
+	{ 0xa61 << 2, 0x00},
+	{ 0xa62 << 2, 0x00},
+	{ 0xa63 << 2, 0x00},
+	{ 0xa64 << 2, 0x00},
+	{ 0xa65 << 2, 0x00},
+	{ 0xa66 << 2, 0x00},
+	{ 0xa67 << 2, 0x00},
+	{ 0xa68 << 2, 0x00},
+	{ 0xa69 << 2, 0x00},
+	{ 0xa6A << 2, 0x00},
+	{ 0xa6B << 2, 0x00},
+	{ 0xa6C << 2, 0x00},
+	{ 0xa6D << 2, 0x00},
+	{ 0xa6E << 2, 0x00},
+	{ 0xa6F << 2, 0x00},
+	{ 0xa70 << 2, 0x00},
+	{ 0xa71 << 2, 0x00},
+	{ 0xa72 << 2, 0x00},
+	{ 0xa73 << 2, 0x00},
+	{ 0xa74 << 2, 0x00},
+	{ 0xa75 << 2, 0x00},
+	{ 0xa76 << 2, 0x00},
+	{ 0xa77 << 2, 0x00},
+	{ 0xa78 << 2, 0x00},
+	{ 0xa79 << 2, 0x00},
+	{ 0xa7A << 2, 0x00},
+	{ 0xa7B << 2, 0x00},
+	{ 0xa7C << 2, 0x00},
+	{ 0xa7D << 2, 0x00},
+	{ 0xa7E << 2, 0x00},
+	{ 0xa7F << 2, 0xd8},
+	{ 0xa80 << 2, 0x1a},
+	{ 0xa81 << 2, 0xff},
+	{ 0xa82 << 2, 0x01},
+	{ 0xa83 << 2, 0x00},
+	{ 0xa84 << 2, 0x00},
+	{ 0xa85 << 2, 0x00},
+	{ 0xa86 << 2, 0x00},
+	{ 0xa87 << 2, 0xf0},
+	{ 0xa88 << 2, 0xff},
+	{ 0xa89 << 2, 0xff},
+	{ 0xa8A << 2, 0xff},
+	{ 0xa8B << 2, 0xff},
+	{ 0xa8C << 2, 0x1c},
+	{ 0xa8D << 2, 0xc2},
+	{ 0xa8E << 2, 0xc3},
+	{ 0xa8F << 2, 0x3f},
+	{ 0xa90 << 2, 0x0a},
+	{ 0xa91 << 2, 0x00},
+	{ 0xa92 << 2, 0x00},
+	{ 0xa93 << 2, 0x00},
+	{ 0xa94 << 2, 0x00},
+	{ 0xa95 << 2, 0x00},
+	{ 0xa96 << 2, 0xf8},
+	{ 0x000 << 2, 0x07},
+};
+#endif
+#endif
